<template class="component-template">
  <link rel="stylesheet" href="settings.css">

  <div id="wrapper">
    <div class="settingsWrapper">
      <form action="#" id='settings-form'>
        <div class="setting">
          <label for="circleFontSize">Font size for circle text:</label>
          <input class="number" id="circleFontSize" name="circleFontSize" value="12" min="0" max="50">
        </div>
        <div class="setting">
          <label for="circlePadding">Padding between circles:</label>
          <input class="number" id="circlePadding" name="circlePadding" value="10" min="0">
        </div>
        <div class="setting buttons">
          <input type="reset" value="reset" class="button">
          <input type="submit" value="submit" class="button">
        </div>
      </form>
    </div>
  </div>
</template>

<script>
  (function () {
    const infrastructure = require('web-component-infrastructure');
    const ownerDocument = infrastructure.workarounds.getOwnerDocument();
    let onChanged;

    function applySizes(form) {
      onChanged(form.circleFontSize.value, form.circlePadding.value);
      return false;
    }

    class VisualizationSettings extends infrastructure.WebComponentElement {
      constructor() {
        super(ownerDocument);
      }

      postConnected() {
        // FIXME: Remove the whole form thing, just react to key presses
        this.getShadowRoot().querySelector('#settings-form').onsubmit = function () {
          return applySizes(this);
        }
      }

      initialize(settingsInit) {
        this.getShadowRoot().querySelector('#circleFontSize').setAttribute("value", settingsInit.initialCircleFontSize);
        this.getShadowRoot().querySelector('#circlePadding').setAttribute("value", settingsInit.initialCirclePadding);
        onChanged = settingsInit.onSettingsChanged;
      }
    }

    window.customElements.define('visualization-settings', VisualizationSettings);
  })();
</script>