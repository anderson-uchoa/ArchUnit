<template id="template-filter">
    <head>
        <link rel="stylesheet" href="filter.css">
        <style>
            * {
                box-sizing: border-box;
            }
        </style>
    </head>
    <body>
    <div id="wrapper">
        <div class="filterGroupWrapper">
            <div class="filterType">Classes</div>
            <div class="filterGroup left">
                <form action="#" onsubmit="return filterClassesByType(this);">
                    <div class="filter">
                        <input type="checkbox" name="interfaces" value="interfaces" checked>
                        <label>interfaces</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="classes" value="classes" checked>
                        <label>classes</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="hideEmptyPkgs" value="hideEmptyPkgs" checked>
                        <label>hide empty packages</label>
                    </div>
                    <div class="filter buttons">
                        <input type="reset" value="reset" class="button">
                        <input type="submit" value="submit" class="button">
                    </div>
                </form>
            </div>
        </div>
        <div class="filterGroupWrapper">
            <div class="filterType">Dependencies</div>
            <div class="filterGroup right">
                <form action="#" onsubmit="return filterDependenciesByType(this);">
                    <div class="filter">
                        <input type="checkbox" name="implementing" value="implementing" checked>
                        <label>implementing</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="extending" value="extending" checked>
                        <label>extending</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="constructorCall" value="constructorCall" checked>
                        <label>constructor call</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="methodCall" value="methodCall" checked>
                        <label>method call</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="fieldAccess" value="fieldAccess" checked>
                        <label>field access</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="anonymousImplementation" value="anonymousImplementation" checked>
                        <label>anonymous implementation</label>
                    </div>
                    <div class="filter">
                        <input type="checkbox" name="betweenClassAndItsInnerClasses"
                               value="betweenClassAndItsInnerClasses">
                        <label>between class and its inner classes</label>
                    </div>
                    <div class="filter buttons">
                        <input type="reset" value="reset" class="button">
                        <input type="submit" value="submit" class="button">
                    </div>
                </form>
            </div>
        </div>
    </div>
    </body>
</template>
<script src="css-adapter-bundle.js"></script>
<script>
  let filterVars = {
    document: document.currentScript ? document.currentScript.ownerDocument : document._currentScript.ownerDocument,
    shadowRoot: undefined,
    onClassFilterChanged: undefined,
    onDependenciesFilterChanged: undefined
  };

  function filterClassesByType(form) {
    filterVars.onClassFilterChanged(form.interfaces.checked, form.classes.checked, form.hideEmptyPkgs.checked);
    return false;
  }

  function filterDependenciesByType(form) {
    filterVars.onDependenciesFilterChanged({
      implementing: form.implementing.checked,
      extending: form.extending.checked,
      constructorCall: form.constructorCall.checked,
      methodCall: form.methodCall.checked,
      fieldAccess: form.fieldAccess.checked,
      anonymousImplementation: form.anonymousImplementation.checked,
      betweenClassAndItsInnerClasses: form.betweenClassAndItsInnerClasses
    });
    return false;
  }

  class VisualizationFilter extends HTMLElement {

    constructor() {
      super();
    }

    connectedCallback() {
      filterVars.shadowRoot = this.attachShadow({mode: 'open'});
      let template = filterVars.document.querySelector('#template-filter');
      filterVars.shadowRoot.appendChild(template.content.cloneNode(true));
    }

    initialize(onClassFilterChanged, onDependenciesFilterChanged) {
      filterVars.onClassFilterChanged = onClassFilterChanged;
      filterVars.onDependenciesFilterChanged = onDependenciesFilterChanged;
    }
  }

  window.customElements.define('visualization-filter', VisualizationFilter);
</script>